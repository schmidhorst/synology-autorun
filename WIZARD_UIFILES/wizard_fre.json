[{
"step_title":"Configuration",
"items": [
{"type": "textfield",
"desc":"Le script doit être situé dans le répertoire racine du périphérique externe et défini comme exécutable pour l'utilisateur 'root'. Il obtient le point de montage du périphérique (par exemple /volumeUSB1/usbshare/) comme premier paramètre ($1) et la partition du périphérique (par exemple usb1p1) comme second ($2). Astuce : Le script est exécuté avec un environnement vide, vous devez spécifier toutes les commandes utilisées avec le chemin !",
"subitems": [{
"key": "config_SCRIPT",
"desc":"Script à exécuter",
"defaultValue": "@SCRIPT@",
"validator": { "allowBlank": false }
}]
}
,{
"type": "textfield",
"desc":"Une valeur de sortie de 100 du script démontera et éjectera le périphérique lorsque le script sera terminé, toutes les autres valeurs de sortie le laisseront monté. Vous pouvez arrêter l'autorun dans le centre de paquets pour le désactiver temporairement.<br/><br/>Le temps de recherche est le temps après le déclenchement par udev pour trouver le point de montage lorsqu'un périphérique est attaché. Le temps d'attente supplémentaire donne au DSM une certaine marge de manœuvre pour monter correctement le lecteur avant de lancer le script.<br/>Vous devrez peut-être augmenter ces temps en fonction de votre matériel.",
"subitems": [
{
"key": "config_TRIES",
"desc":"Temps de recherche (sec)",
"defaultValue": "@TRIES@",
"validator": {
"allowBlank": false,
"fn": "{if (/^([0-9]+)$/.test(arguments[0])) return true; return 'Enter a positive number!'; }"
}
}
,{
"key": "config_WAIT",
"desc":"Temps d'attente (sec)",
"defaultValue": "@WAIT@",
"validator": {
"allowBlank": false,
"fn": "{if (/^([0-9]+)$/.test(arguments[0])) return true; return 'Enter a positive number!'; }"
}
}
]
}
,{
"type": "textfield",
"desc":"La taille des fichiers journaux est automatiquement limitée. Si le nombre de lignes donné est atteint, la moitié la plus ancienne est supprimée.",
"subitems": [
{
"key": "config_LOG_MAX_LINES",
"desc":"Nombre maximal de lignes",
"defaultValue": "@LOG_MAX_LINES@",
"validator": {
"allowBlank": false,
"fn": "{if (/^([0-9]+)$/.test(arguments[0])) return true; return 'Enter a positive number!'; }"
}
}
]
}
,{
"type": "textfield",
"desc":"Le paquet génère des messages DSM, qui sont affichés sur le bureau pour les groupes d'utilisateurs ou les utilisateurs configurables. Ajoutez un @ aux noms de groupes, par exemple @users pour tous les utilisateurs.",
"subitems": [{
"key": "config_NOTIFY_USERS",
"desc":"Affichage du message sur",
"width": "360",
"defaultValue": "@NOTIFY_USERS@",
"validator": { "allowBlank": true }
}
]
}
,{
"type": "combobox",
"desc":"Utilisation de la 'LED de copie' :<br/>0 : les LED ne sont pas du tout utilisées.<br/>1 : allumées pendant la course ou l'éjection, éteintes ensuite<br/>2 : clignotantes pendant la course ou l'éjection, éteintes ensuite<br/>3 : allumées pendant la course ou l'éjection, éteintes ensuite (0/100) ou clignotantes (autres codes)<br/>4 : clignotantes pendant la course ou l'éjection, éteintes ensuite ou clignotantes (autres codes ou éjection défaillante)<br/>5 : clignotantes pendant la course ou l'éjection, éteintes ensuite (0/100) ou allumées (autres codes ou éjection défaillante).",
"subitems": [{
"key": "config_LED_COPY",
"autoSelect": true,
"editable": false,
"desc":"LED de copie",
"defaultValue": "@LED_COPY@",
"width": "360",
"mode": "local",
"valueField": "myId",
"displayField": "displayText",
"store": {
"xtype": "arraystore",
"fields": ["myId", "displayText"],
"data": [[0, "0 Not used"], [1, "1 ON - ON - OFF"], [2, "2 flash - flash - OFF"], [3, "3 ON - ON - OFF or flash"], [4, "4 flash - flash - OFF or flash"], [5, "5 flash - flash - OFF or ON"]]
}
}]
}
,{
"type": "combobox",
"desc":"Utilisation de la LED d'état :<br/>0 : Pas utilisé du tout<br/>1 : Vert en cours d'exécution, vert clignotant pendant l'éjection, OFF si terminé avec 0 ou 100, orange clignotant pour d'autres résultats ou échec de l'éjection<br/>2 : Vert clignotant pendant l'exécution du script ou l'éjection, vert si terminé avec 0 ou 100, orange clignotant pour d'autres résultats ou échec de l'éjection<br/>3 : Vert pendant l'exécution du script et pendant l'éjection, OFF si terminé, orange clignotant si échec de l'éjection.",
"subitems": [{
"key": "config_LED",
"autoSelect": true,
"editable": false,
"desc":"LED d'état",
"width": "360",
"mode": "local",
"valueField": "myId",
"displayField": "displayText",
"defaultValue": "@LED@",
"store": {
"xtype": "arraystore",
"fields": ["myId", "displayText"],
"data": [[0, "0 Not used"], [1, "1 grn - grnFlash - OFF or orgFlash"], [2, "2 grnFlash - grnFlash - grn or orgFlash"], [3, "3 grn - grn - OFF or orgFlash"]]
}
}]
}
,{
"type": "multiselect",
"desc":"<br/>Indicateur d'état pendant l'exécution du script.",
"subitems": [{
"key": "config_BEEP",
"desc":"Bip au début et à la fin",
"defaultValue": "@BEEP@"
}]
}
,{
"type": "textfield",
"desc":"Si le script se termine par le code de sortie 100, il sera tenté d'éjecter le périphérique. Vous pouvez spécifier le délai (en secondes) d'éjection du périphérique.",
"subitems": [{
"key": "config_EJECT_TIMEOUT",
"desc":"Délai d'éjection [s]",
"defaultValue": "@EJECT_TIMEOUT@",
"validator": {
"allowBlank": false,
"fn": "{if (/^([0-9]+)$/.test(arguments[0])) return true; return 'Enter a positive number!'; }"
}
}]
}
,{
"type": "textfield",
"desc":"Vous pouvez éventuellement spécifier un autre script (avec le chemin d'accès complet !) qui, en cas d'éjection demandée (avec le code de sortie 100 de votre premier script), sera exécuté après l'éjection. Ceci peut être utilisé, par exemple, pour éteindre votre périphérique USB. Si l'éjection a échoué, l'argument sera 'Ejection failed', en cas de succès aucun argument !",
"subitems": [{
"key": "config_SCRIPT_AFTER_EJECT",
"desc":"Script après éjection (sur DSM)",
"width": "350",
"defaultValue": "@SCRIPT_AFTER_EJECT@",
"validator": {
"allowBlank": true
}
}]
}]
}
,{
"step_title":"Configuration de la sécurité",
"items": [{
"type": "combobox",
"desc":"Le script avec le nom correspondant sur votre périphérique USB est exécuté avec les privilèges root sur votre DSM ! Cela peut constituer un risque pour la sécurité ! Pour une meilleure sécurité, une restriction aux scripts avec des valeurs de hachage sha256 préenregistrées (empreintes digitales) est possible.<br/>En fait, il y a @ENTRY_COUNT@ hachages de scripts enregistrés.<br/>0 : La fonction de sécurité n'est pas utilisée. Tous les scripts dont le nom correspond sont autorisés. Aucun changement des hashs enregistrés.<br/>1 : Les hashs enregistrés précédents sont probablement tous supprimés maintenant. Le 1er script après l'installation/configuration sera enregistré et est autorisé à être exécuté ensuite encore et encore.<br/>2 : La valeur de hachage de tout script avec le nom correspondant sera enregistrée et exécutée ! (Ajouter les hachages)<br/>3 : Seuls les scripts précédemment enregistrés sont autorisés. (Enregistrement gelé)",
"subitems": [{
"key": "config_ADD_NEW_FINGERPRINTS",
"autoSelect": true,
"editable": false,
"desc":"Enregistrement de Script Hash",
"width": "360",
"mode": "local",
"valueField": "myId",
"displayField": "displayText",
"defaultValue": "@ADD_NEW_FINGERPRINTS@",
"store": {
"xtype": "arraystore",
"fields": ["myId", "displayText"],
"data": [[0, "0 Feature not used (unrestricted)"], [1, "1 1st script allowed"], [2, "2 Add any hash value"], [3, "3 Only previously registered"]]
}
}]
}]
}
,{
"step_title":"IMPORTANT : Action manuelle requise !",
"items": [{
"type": "textfield",
"desc":"Les paquets tiers sont restreints par Synology dans DSM 7.x ! Étant donné que l'autorun nécessite une autorisation root pour effectuer son travail, une étape manuelle supplémentaire est nécessaire après l'installation.<br/><br/>SSH à votre NAS (en tant qu'utilisateur admin) et exécutez la commande suivante une fois l'installation terminée. Copiez-le maintenant !",
"subitems": [{
"key": "ignore_value",
"desc":"Commande",
"width": "440",
"defaultValue": "sudo cp /var/packages/autorun/conf/privilege.root /var/packages/autorun/conf/privilege"
}]
}]
}
]

